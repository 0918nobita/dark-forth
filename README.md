# DARK FORTH

- FORTH 言語の入門書
- PDF で内容を無料公開
- A5 サイズ平綴じ冊子にして技術書典7で頒布予定

## 内容

- 基本的なスタック操作ワードの使い方・インタプリタモードでの動作原理
- Interpretation / Compilation / Execution / Runtime / Initiation Semantics の違い
- ``IMMEDIATE`` / ``POSTPONE`` ワードについて
- メモリ操作ワード・変数・配列・固定長文字列について
- Compilation Words を用いたマクロの作成
- データ構造とその実装

## 目次

- まえがき
- はじめに
  - 推奨する読み方
  - 本文中での記法
  - 準備
  - FORTH の歴史
  - 役立つリファレンス
- 序論
  - ワードとインタプリタ
  - 逆ポーランド記法
  - 練習問題
- リターンスタック
- 変数 / 配列

## 練習問題

### FORTH 序論

1. ``6 - 7 × 8 + 9`` を Gforth 上で計算せよ。

```
6 7 8 * - 9 +
```

2. ``2SWAP`` ワードのスタック表記を示せ。

```
( x1 x2 x3 x4 -- x3 x4 x1 x2 )
```

3. スタック上の ``x, y`` をポップし、``y × 2 + x`` をプッシュするワード ``word2-3`` を定義せよ。

```
: word2-3  ( n1 n2 -- n3 )  * + ;
```

4. スタック上の ``x, y`` をポップし、``x mod 3 - y / 4`` をプッシュするワード ``word2-4`` を定義せよ。

解答例1:

```
: word2-4  ( n1 n2 -- n3 )  SWAP 3 MOD SWAP 4 / - ;
```

解答例2:

```
: word2-4  ( n1 n2 -- n3 )  -4 / SWAP 3 MOD + ;
```

5. ``NIP`` ワードと同じ挙動のワード ``word2-5`` を定義せよ。ただし、定義に「``NIP`` ワードの呼び出し」を含めてはいけない。

```
: word2-5  ( x1 x2 -- x2 )  SWAP DROP ;
```

### 制御構造

1. データスタックに積んだ 1 セル整数の回数だけ、FizzBuzz を実行するワードを定義せよ。
2. フィボナッチ数を求めるワード ``fib ( n1 -- n2 )`` を定義せよ。

```
: fib  ( n1 -- n2 )
  CASE
    0 OF 0 ENDOF
    1 OF 1 ENDOF
    0 1 ROT 0 DO 2DUP + ROT DROP LOOP
  ENDCASE
;
```

3. リターンスタック操作のワードを利用して、``OVER`` ワードを実装せよ。

```
: OVER  >R DUP R> SWAP ;
```
